import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24zCiNjb2Rpbmc9dXRmLTgKCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCB0aW1lCmltcG9ydCBqc29uCmltcG9ydCByYW5kb20KaW1wb3J0IHNvY2tldAppbXBvcnQgc2h1dGlsCmltcG9ydCB3ZWJicm93c2VyCmltcG9ydCBjb25jdXJyZW50LmZ1dHVyZXMKCnRyeToKICBfX2ltcG9ydF9fKCdyZXF1ZXN0cycpCmV4Y2VwdCBNb2R1bGVOb3RGb3VuZEVycm9yOgogIG9zLnN5c3RlbSAoJ3BpcDMgaW5zdGFsbCByZXF1ZXN0cycpCmZpbmFsbHk6CiAgaW1wb3J0IHJlcXVlc3RzCgp0cnk6CiAgX19pbXBvcnRfXygnYnM0JykKZXhjZXB0IE1vZHVsZU5vdEZvdW5kRXJyb3I6CiAgb3Muc3lzdGVtICgicGlwMyBpbnN0YWxsIGJzNCIpCmZpbmFsbHk6CiAgZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAgYXMgcGFyc2VyCgpVUERBVEUgPSAiMTAtMTEtMjAyMSAxMzowNyIKCmlmICdsaW51eCcgaW4gc3lzLnBsYXRmb3JtOgogIHIgPSAiXDAzM1s5MW0iICMgUmVkCiAgZyA9ICJcMDMzWzkybSIgIyBHcmVlbgogIHkgPSAiXDAzM1s5M20iICMgWWVsbG93CiAgcCA9ICJcMDMzWzk0bSIgIyBQdXJwbGUKICBQID0gIlwwMzNbOTVtIiAjIFBpbmsKICBjID0gIlwwMzNbOTZtIiAjIEN5YW4KICB3ID0gIlwwMzNbOTdtIiAjIFdoaXRlCiAgYSA9ICJcMDMzWzBtIiAgIyBSZXNldAplbHNlOgogICMgQ29udmVydCBTdHJpbmcgVG8gVmFyaWFiZWwgTmFtZQogIGZvciBpIGluIFsncicsJ2cnLCd5JywncCcsJ1AnLCdjJywndycsJ2EnXToKICAgIGdsb2JhbHMoKVtpXSA9ICIiCgp0cnk6CiAgcHJpbnQgKGYie3B9W3t5fSF7cH1dIHtyfU1lbmdodWJ1bmdrYW4gS2UgU2VydmVyIikKICBkYXRhID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL3d3dy5tZWRpYWZpcmUuY29tL2FwaS8xLjQvZm9sZGVyL2dldF9jb250ZW50LnBocD9jb250ZW50X3R5cGU9ZmlsZXMmZmlsdGVyPWFsbCZvcmRlcl9ieT1uYW1lJm9yZGVyX2RpcmVjdGlvbj1hc2MmY2h1bms9MSZ2ZXJzaW9uPTEuNSZmb2xkZXJfa2V5PXVldGk5Y2lqNHpmM2kmcmVzcG9uc2VfZm9ybWF0PWpzb24iKS5qc29uKCkKICBmaWxlcyA9IGRhdGFbJ3Jlc3BvbnNlJ11bJ2ZvbGRlcl9jb250ZW50J11bJ2ZpbGVzJ10KZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICBleGl0KGYie3B9W3t5fSF7cH1dIHtyfVRpZGFrIEFkYSBLb25la3NpIXthfSIpCgpjb2xvcnMgPSBsYW1iZGEgOiByYW5kb20uY2hvaWNlKFtyLGcseSxwLFAsYyx3XSkKbG9nbyA9IGYie3J9XG57cH3ilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZdcbuKVkVt7eX3igKJ7cH1dIHtjfUF1dGhvciA6IHtnfVBhc3lhR2FueiAgICAgICAgICAgICB7cH0gIOKVkVxu4pWRW3t5feKAontwfV0ge2N9R2l0SHViIDoge3d9Z2l0aHViLmNvbS9wYXN5YWdhbnogIHtwfSAg4pWRXG7ilZFbe3l94oCie3B9XSB7Y31XQS4gICAgOiB7eX0rNjIgODk1MzM0NDAyNDU2ICAgICAgICB7cH3ilZFcbuKVkVt7eX3igKJ7cH1dIHtjfVVQREFURSA6IHtVUERBVEV9ICAgICAge3B9ICDilZFcbuKVkVt7eX3igKJ7cH1dIHtjfVB5dGhvbiA6IHtjb2xvcnMoKX17c3lzLnZlcnNpb25bMDo2XX0gICAgICAgICAgICAgICAge3B9ICDilZFcbuKVkVt7eX3igKJ7cH1dIHtjfU9TICAgICA6IHtjb2xvcnMoKX17c3lzLnBsYXRmb3JtfXsnICcqKDIzIC0gbGVuKHN5cy5wbGF0Zm9ybSkpfXtwfSDilZFcbuKVkVt7eX3igKJ7cH1dIHtjfUhvc3QgICA6IHtjb2xvcnMoKX17c29ja2V0LmdldGhvc3RuYW1lKCl9eycgJyooMjQgLSBsZW4oc29ja2V0LmdldGhvc3RuYW1lKCkpKX17cH3ilZFcbuKVkVt7eX3igKJ7cH1dIHtjfVRlYW0uICA6IHtjb2xvcnMoKX1OTyBOQU1FIHtjb2xvcnMoKX1URUFNUyB7cn1VTkt7d31OT1dOe3B9ICAg4pWRXG7ilZrilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZ17YX0iCgp0cnk6CiAgb3MubWtkaXIoJ3ZpcnRleCcpCmV4Y2VwdCBGaWxlRXhpc3RzRXJyb3I6CiAgcGFzcwoKZGVmIE1veWEoZmlsZSk6CiAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHNlc2k6CiAgICAgcHJpbnQgKGYie3B9W3t5fSF7cH1dIHt5fURvd25sb2FkaW5nIHtmaWxlWydmaWxlbmFtZSddfSIpCiAgICAgYSA9IHNlc2kuZ2V0KGZpbGVbJ2xpbmtzJ11bJ25vcm1hbF9kb3dubG9hZCddKQogICAgIGIgPSBwYXJzZXIoYS5jb250ZW50LCdodG1sLnBhcnNlcicpLmZpbmQoJ2EnLGNsYXNzXyA9ICdwb3Bzb2snKVsnaHJlZiddCiAgICAgYyA9IHNlc2kuZ2V0KGIpLmNvbnRlbnQKICAgICBkID0gb3MucGF0aC5qb2luKCd2aXJ0ZXgnLGZpbGVbJ2ZpbGVuYW1lJ10pCiAgICAgZSA9IG9zLm9wZW4oZCxvcy5PX0NSRUFUIHwgb3MuT19XUk9OTFkpCiAgICAgb3Mud3JpdGUoZSxjKQogICAgIG9zLmNsb3NlKGUpCgoKZGVmIG1haW4oKToKICB0cnk6CiAgICBvcy5zeXN0ZW0gKCdjbGVhcicpCiAgICBwcmludCAobG9nbykKICAgIHByaW50ICgiJXNQSUxJSCBKRU5JUyBWSVJURVgiICUgKGcpKQogICAgcHJpbnQgKCIlcyVzJXMiICUgKGMsJz0nKjQzLGEpKQogICAgZm9yIGtoYW5leXNpYSxyYWhtYXQgaW4gZW51bWVyYXRlKGZpbGVzLCBzdGFydCA9IDEpOgogICAgICBwcmludCAoZiJ7cH1be3J9e3N0cihraGFuZXlzaWEpLnpmaWxsKDIpfXtwfV0ge2NvbG9ycygpfXtvcy5wYXRoLnNwbGl0ZXh0KHJhaG1hdFsnZmlsZW5hbWUnXSlbMF19IikKICAgIHByaW50IChmIntwfVt7cn1BTHtwfV0ge2N9VU5EVUggU0VNVUEgVklSVEVYXG57cH1be3J9QkF7cH1dIHt5fUtFTUJBTEkgS0UgTUVOVSBVVEFNQVxue3B9W3tyfUVYe3B9XSB7cn1LRUxVQVIgREFSSSBQUk9HUkFNIikKICAgIGVjaGEgPSBpbnB1dCgiJXM+Pj4+ICVzIiAlIChnLGMpKS5sb3dlcigpCiAgICBpZiBlY2hhID09ICdhbCc6CiAgICAgIHdpdGggY29uY3VycmVudC5mdXR1cmVzLlRocmVhZFBvb2xFeGVjdXRvcigxNSkgYXMgZXhlY3V0b3I6CiAgICAgICAgZXhlY3V0b3IubWFwKE1veWEsIGZpbGVzKQogICAgICBzaHV0aWwubWFrZV9hcmNoaXZlKCd2aXJ0ZXgtbWFzdGVyJywnemlwJywndmlydGV4JykKICAgICAgcHJpbnQgKGYie3B9W3tnfeKck3twfV0ge2d9RG93bmxvYWQgQ29tcGxldGUiKQogICAgICBleGl0IChmIntwfVt7Z33inJN7cH1dIHtnfURvd25sb2FkIFJlc3VsdHMgU2F2ZWQgSW4gOiB7b3MucGF0aC5yZWFscGF0aCgndmlydGV4Jyl9IikKICAgIGVsaWYgZWNoYSA9PSAnYmEnOgogICAgICBtZW51KCkKICAgIGVsaWYgZWNoYSA9PSAnZXgnOgogICAgICBvcy5hYm9ydCgpCiAgICBlbGlmIGludChlY2hhKSBpbiByYW5nZSgxLGxlbihmaWxlcykgKyAxKToKICAgICAgcmFobWV0ID0gZmlsZXNbaW50KGVjaGEpIC0gMV0KICAgICAga250bCA9IDAKICAgICAgcHJpbnQgKGYie3B9W3t5fSF7cH1dIHt5fURvd25sb2FkaW5nIHtyYWhtZXRbJ2ZpbGVuYW1lJ119IikKICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICBzZXMgPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgICAgICAgIHJlcSA9IHNlcy5nZXQocmFobWV0WydsaW5rcyddWydub3JtYWxfZG93bmxvYWQnXSkKICAgICAgICAgIHJlcyA9IHBhcnNlcihyZXEuY29udGVudCwnaHRtbC5wYXJzZXInKQogICAgICAgICAgcHJpbnQgKGYie3B9W3t5feKck3twfV0ge3l9VVJMIDoge3JlcS51cmx9IikKICAgICAgICAgIHByaW50IChmIntwfVt7eX3inJN7cH1dIHt5fVN0YXR1cyA6IHtyZXEuc3RhdHVzX2NvZGV9IikKICAgICAgICAgIHVybCA9IHJlcy5maW5kKCdhJyxjbGFzc18gPSAncG9wc29rJylbJ2hyZWYnXQogICAgICAgICAgcGF0aCA9IG9zLnBhdGguam9pbigndmlydGV4JyxyYWhtZXRbJ2ZpbGVuYW1lJ10pCiAgICAgICAgICBmaWxlID0gb3Mub3BlbihwYXRoLG9zLk9fQ1JFQVQgfCBvcy5PX1dST05MWSkKICAgICAgICAgIHR4dCA9IHNlcy5nZXQodXJsKS5jb250ZW50CiAgICAgICAgICBvcy53cml0ZShmaWxlLHR4dCkKICAgICAgICAgIG9zLmNsb3NlKGZpbGUpCiAgICAgICAgICBieXRlID0gb3Muc3RhdChwYXRoKS5zdF9zaXplCiAgICAgICAgICBmb3IgYiBpbiBbJ0InLCdLQicsJ01CJywnR0InLCdUQiddOgogICAgICAgICAgICBpZiBieXRlIDwgMTAyNC4wOgogICAgICAgICAgICAgIGJ5dGUgPSAiJTMuMmYgJXMiICUgKGJ5dGUsYikKICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgIGJ5dGUgLz0gMTAyNC4wCiAgICAgICAgICBwcmludCAoZiJ7cH1be3l94pyTe3B9XSB7Z31GaWxlIE5hbWUgOiB7b3MucGF0aC5iYXNlbmFtZShwYXRoKX0iKQogICAgICAgICAgcHJpbnQgKGYie3B9W3t5feKck3twfV0ge2d9RmlsZSBTaXplIDoge2J5dGV9IikKICAgICAgICAgIHByaW50IChmIntwfVt7eX3inJN7cH1dIHtnfUZpbGUgUGF0aCA6IHtvcy5wYXRoLnJlYWxwYXRoKHBhdGgpfSIpCiAgICAgICAgICBzaG93ID0gaW5wdXQoZiJ7cH1be3l9P3twfV0ge3d9TGloYXQgSGFzaWwgRG93bmxvYWQgW3tnfVkve3d9e3J9bnt3fV0ge1B9IikubG93ZXIoKSA9PSAneScKICAgICAgICAgIGlmIHNob3c6CiAgICAgICAgICAgIG9zLnN5c3RlbSAoZiJ4ZGctb3BlbiAtLXZpZXcgdmlydGV4Lyd7cmFobWV0WydmaWxlbmFtZSddfSciKQogICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgbWFpbigpCiAgICAgICAgICBicmVhawogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgc3U6CiAgICAgICAgICBrbnRsICs9IDEKICAgICAgICAgIGlmIGtudGwgPj0gNToKICAgICAgICAgICAgcHJpbnQgKGYie3B9W3t5fSF7cH1dIHt5fUdhZ2FsIFRlcmh1YnVuZyBLZSBTZXJ2ZXJcblxuXHRDb2JhIDpcblx0XHTigKIgTm9uYWt0aWZrYW4gbW9kZSBwZXNhd2F0XG5cdFx04oCiIEFrdGlma2FuIGRhdGEgc2VsdWxlciBhdGF1IFdpLUZpXG5cdFx04oCiIFBlcmlrc2Egc2lueWFsIGRpIGFyZWEgQW5kYXthfSIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCAoZiJ7cH1be3l9IXtwfV0ge3l9TWVuY29iYSBNZW5naHVidW5na2FuIHVsYW5nIGtlIHNlcnZlciIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMS41KQogICAgZWxzZToKICAgICAgcmFpc2UgVmFsdWVFcnJvcigpCgogIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgcHJpbnQgKGYie3l9WyFdIEludmFsaWQgSW5wdXQhIikKICAgIHRpbWUuc2xlZXAoMSkKICAgIG1haW4oKQoKZGVmIG1lbnUoKToKICBvcy5zeXN0ZW0oJ2NsZWFyJykKICBwcmludCAobG9nbykKICBwcmludCAoZyArICJNRU5VIFVUQU1BIikKICBwcmludCAoIiVzJXMiICUgKGMsIj0iKjM3KSkKICBwcmludCAoZid7cH1be3l9MXtwfV0ge2d9RE9XTkxPQUQgRklMRSBWSVJURVhcbntwfVt7eX0ye3B9XSB7eX1MQVBPUktBTiBCVUdcbntwfVt7eX0ze3B9XSB7eX1BQk9VVFxue3B9W3t5fTB7cH1dIHtyfUtFTFVBUicpCiAgY2hvaWNlID0gaW5wdXQoIiVzPj4+ICVzIiAlICh5LGMpKQogIGlmIGNob2ljZSA9PSAnMScgb3IgY2hvaWNlID09ICcwMSc6CiAgICBtYWluKCkKICBlbGlmIGNob2ljZSA9PSAnMicgb3IgY2hvaWNlID09ICcwMic6CiAgICB1cmwgPSAiaHR0cHM6Ly93YS5tZS82Mjg5NTMzNDQwMjQ1NiIKICAgIGNvZGUgPSB3ZWJicm93c2VyLm9wZW4odXJsKQogICAgaWYgY29kZToKICAgICAgdGltZS5zbGVlcCgwLjkpCiAgICAgIG1lbnUoKQogICAgZWxzZToKICAgICAgb3Muc3lzdGVtICgieGRnLW9wZW4gIit1cmwpCiAgICAgIHRpbWUuc2xlZXAoMC45KQogICAgICBtZW51KCkKICBlbGlmIGNob2ljZSA9PSAnMycgb3IgY2hvaWNlID09ICcwMyc6CiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgIHByaW50IChmIntsb2dvfVxue2d9SU5GTyBTQ1JJUFRcbj09PT09PT09PT09PT09PT09PT09PT09PVxue3B9W3t5feKck3twfV0ge2N9QXV0aG9yOiB7Z31ObyBOYW1lXG57cH1be3l94pyTe3B9XSB7Y31UZWFtICA6IHtjb2xvcnMoKX1Ob3Qge2NvbG9ycygpfVRlYW1zIHtyfVVua3t3fW5vd25cbntwfVt7eX3inJN7cH1dIHtjfVNjcmlwdDoge2NvbG9ycygpfXtvcy5wYXRoLmJhc2VuYW1lKHN5cy5hcmd2WzBdKX1cbntwfVt7eX3inJN7cH1dIHtjfVBhdGggIDoge29zLnBhdGgucmVhbHBhdGgoc3lzLmFyZ3ZbMF0pfVxue3B9W3t5feKck3twfV0ge2N9U2l6ZSAgOiB7b3Muc3RhdChvcy5wYXRoLnJlYWxwYXRoKHN5cy5hcmd2WzBdKSkuc3Rfc2l6ZX0gQnl0ZVxue3B9W3t5feKck3twfV0ge2N9TGluayAgOiB7Y29sb3JzKCl9aHR0cHM6Ly9naXRodWIuY29tL3Bhc3lhZ2Fuelxue3B9W3t5feKck3twfV0ge2N9VXBkYXRlOiB7Y29sb3JzKCl9e1VQREFURX1cbntwfVt7eX3inJN7cH1dIHtjfVZlcnNpIDogMS4xXG5cbntnfUNvbnRhY3QgTWUgXl9eXG49PT09PT09PT09PT09PT09PT1cbntwfVt7eX3inJN7cH1dIHtjfUdpdGh1Yjoge2NvbG9ycygpfWh0dHBzOi8vZ2l0aHViLmNvbS9wYXN5YWdhbnovXG57cH1be3l94pyTe3B9XSB7Y31GYi4gICA6IHtjb2xvcnMoKX1odHRwczovL3d3dy5mYWNlYm9vay5jb20vQmxhY2tKYWNrMjQ0XG57cH1be3l94pyTe3B9XSB7Y31XYS4gICA6IHtjb2xvcnMoKX0rNjIgODk1MzM0NDAyNDU2XG57cH1be3l94pyTe3B9XSB7Y31FbWFpbCA6IHtjb2xvcnMoKX1CbGFja0phY2swMUBnbWFpbC5jb21cbnthfSIpCiAgZWxpZiBjaG9pY2UgPT0gJzAwJyBvciBjaG9pY2UgPT0gJzAnOgogICAgb3MuYWJvcnQoKQogIGVsc2U6CiAgICBwcmludCAoIiVzWyFdIEludmFsaWQgSW5wdXQhIiAlICh5KSkKICAgIHRpbWUuc2xlZXAoMC45KQogICAgbWVudSgpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogIG1lbnUoKQo='))